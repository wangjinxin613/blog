{"title":"6. 打包、发布、升级","uid":"4363a1c8f18b34e52ca1d5e6f6bd7690","slug":"vscode插件开发/6. 打包、发布、升级","date":"2024-05-05T06:52:32.000Z","updated":"2024-05-05T06:52:33.993Z","comments":true,"path":"api/articles/vscode插件开发/6. 打包、发布、升级.json","keywords":null,"cover":[],"content":"<h1 id=\"发布方式\"><a href=\"#发布方式\" class=\"headerlink\" title=\"发布方式\"></a>发布方式</h1><p>插件开发完了，如何发布出去分享给他人呢？主要有3种方法：</p>\n<ul>\n<li>方法一：直接把文件夹发给别人，让别人找到vscode的插件存放目录并放进去，然后重启vscode，一般不推荐；</li>\n<li>方法二：打包成vsix插件，然后发送给别人安装，如果你的插件涉及机密不方便发布到应用市场，可以尝试采用这种方式；</li>\n<li>方法三：注册开发者账号，发布到官网应用市场，这个发布和npm一样是不需要审核的。</li>\n</ul>\n<h1 id=\"本地打包\"><a href=\"#本地打包\" class=\"headerlink\" title=\"本地打包\"></a>本地打包</h1><p>无论是本地打包还是发布到应用市场都需要借助<code>vsce</code>这个工具。</p>\n<p>安装：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i vsce -g</span><br></pre></td></tr></table></figure>\n\n<p>打包成<code>vsix</code>文件：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vsce package</span><br></pre></td></tr></table></figure>\n\n<p>打包的时候如果没有设置<code>repository</code>会有提示，所以最好设置一下。</p>\n<p><img src=\"http://image.haoji.me/201810/20181013_211058_449_1867.png\" alt=\"W1678xH212\"></p>\n<p>生成好的vsix文件不能直接拖入安装，只能从扩展的右上角选择<code>Install from VSIX</code>安装：</p>\n<p><img src=\"http://image.haoji.me/201810/20181013_211221_454_0291.png\" alt=\"W956xH688\"></p>\n<h1 id=\"发布应用市场\"><a href=\"#发布应用市场\" class=\"headerlink\" title=\"发布应用市场\"></a>发布应用市场</h1><p>Visual Studio Code的应用市场基于微软自己的<code>Azure DevOps</code>，插件的身份验证、托管和管理都是在这里。</p>\n<ul>\n<li>要发布到应用市场首先得有应用市场的<code>publisher</code>账号；</li>\n<li>而要有发布账号首先得有<code>Azure DevOps</code>组织；</li>\n<li>而创建组织之前，首先得创建<code>Azure</code>账号；</li>\n<li>创建<code>Azure</code>账号首先得有<code>Microsoft</code>账号；</li>\n</ul>\n<p>是不是有点晕，梳理一下：</p>\n<ul>\n<li>一个Microsoft账号可以创建多个<code>Azure</code>组织；</li>\n<li>一个组织可以创建多个<code>publisher</code>账号；</li>\n<li>同时一个组织可以创建多个<code>PAT</code>（<code>Personal Access Token</code>，个人访问令牌）；</li>\n</ul>\n<h2 id=\"3-1-注册账号\"><a href=\"#3-1-注册账号\" class=\"headerlink\" title=\"3.1. 注册账号\"></a>3.1. 注册账号</h2><p>首先访问 <a href=\"https://login.live.com/\">https://login.live.com/</a> 登录你的<code>Microsoft</code>账号，没有的先注册一个：</p>\n<p><img src=\"http://image.haoji.me/201810/20181013_214258_739_0257.png\" alt=\"W579xH482\"></p>\n<p>然后访问： <a href=\"https://aka.ms/SignupAzureDevOps\">https://aka.ms/SignupAzureDevOps</a> ，如果你从来没有使用过Azure，那么会看到如下提示：</p>\n<p><img src=\"http://image.haoji.me/201810/20181013_214409_099_0799.png\" alt=\"W479xH330\"></p>\n<p>点击继续，默认会创建一个以邮箱前缀为名的组织。</p>\n<h2 id=\"3-2-创建令牌\"><a href=\"#3-2-创建令牌\" class=\"headerlink\" title=\"3.2. 创建令牌\"></a>3.2. 创建令牌</h2><p>默认进入组织的主页后，点击右上角的<code>Security</code>：</p>\n<p><img src=\"http://image.haoji.me/201810/20181013_214712_447_4540.png\" alt=\"W748xH607\"></p>\n<p>点击创建新的个人访问令牌，这里特别要注意<code>Organization</code>要选择<code>all accessible organizations</code>，<code>Scopes</code>要选择<code>Full access</code>，否则后面发布会失败。</p>\n<p><img src=\"http://image.haoji.me/201810/20181013_215608_127_6001.png\" alt=\"W639xH502\"></p>\n<p>创建令牌成功后你需要本地记下来，因为网站是不会帮你保存的。</p>\n<h2 id=\"3-3-创建发布账号\"><a href=\"#3-3-创建发布账号\" class=\"headerlink\" title=\"3.3. 创建发布账号\"></a>3.3. 创建发布账号</h2><p>获得个人访问令牌后，使用<code>vsce</code>以下命令创建新的发布者：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vsce create-publisher your-publisher-name</span><br></pre></td></tr></table></figure>\n\n<p><code>your-publisher-name</code>必须是字母数字下划线，这是全网唯一的账号，然后会依次要求输入昵称、邮箱、令牌：</p>\n<p><img src=\"http://image.haoji.me/201810/20181013_221104_009_6828.png\" alt=\"W1200xH294\"></p>\n<p>创建成功后会默认登录这个账号，接下来你可以直接发布了，当然，如果你是在其它地方创建的，可以试用<code>vsce login your-publisher-name</code>来登录。</p>\n<p>除了用命令之外，你还可以使用网页版创建发布账号：<a href=\"https://marketplace.visualstudio.com/manage\">https://marketplace.visualstudio.com/manage</a></p>\n<h2 id=\"3-4-发布\"><a href=\"#3-4-发布\" class=\"headerlink\" title=\"3.4. 发布\"></a>3.4. 发布</h2><p>发布很简单：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vsce publish</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://image.haoji.me/201810/20181013_221636_405_8062.png\" alt=\"W1092xH254\"></p>\n<p>发布成功后大概需要过几分钟才能在应用市场搜到。过几分钟就可以访问网页版的插件主页：<a href=\"https://marketplace.visualstudio.com/items?itemName=sxei.vscode-plugin-demo\">https://marketplace.visualstudio.com/items?itemName=sxei.vscode-plugin-demo</a></p>\n<p><img src=\"http://image.haoji.me/201810/20181013_221942_272_1738.png\" alt=\"W646xH447\"></p>\n<p>vscode里面也能搜到了：</p>\n<p><img src=\"http://image.haoji.me/201810/20181013_222332_214_5966.png\" alt=\"W738xH674\"></p>\n<h3 id=\"3-4-1-发布注意事项\"><a href=\"#3-4-1-发布注意事项\" class=\"headerlink\" title=\"3.4.1. 发布注意事项\"></a>3.4.1. 发布注意事项</h3><ul>\n<li><code>README.md</code>文件默认会显示在插件主页；</li>\n<li><code>README.md</code>中的资源必须全部是<code>HTTPS</code>的，如果是<code>HTTP</code>会发布失败；</li>\n<li><code>CHANGELOG.md</code>会显示在变更选项卡；</li>\n<li>如果代码是放在git仓库并且设置了repository字段，发布前必须先提交git，否则会提示<code>Git working directory not clean</code>；</li>\n</ul>\n<p>另外，如前面所说，如果<code>Organization</code>没有选择<code>all accessible organizations</code>，或者<code>Scopes</code>没有选择<code>Full access</code>，发布的时候可能会报如下错误：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Error: Failed Request: Unauthorized(401) - https://marketplace.visualstudio.com/_apis/gallery</span><br><span class=\"line\">Be sure to use a Personal Access Token <span class=\"built_in\">which</span> has access to **all accessible accounts**.</span><br><span class=\"line\">See https://code.visualstudio.com/docs/tools/vscecli<span class=\"comment\">#_common-questions for more information.</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-4-2-增量发布\"><a href=\"#3-4-2-增量发布\" class=\"headerlink\" title=\"3.4.2. 增量发布\"></a>3.4.2. 增量发布</h3><p>版本号：<code>major.minor.patch</code></p>\n<p>如果想让发布之后版本号的patch自增，例如：<code>1.0.2</code> -&gt; <code>1.0.3</code>，可以这样：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vsce publish patch</span><br></pre></td></tr></table></figure>\n\n<p>执行这个命令后会自动修改<code>package.json</code>里面的版本号。同理，<code>vsce publish minor</code>也是可以的。</p>\n<h2 id=\"3-5-取消发布\"><a href=\"#3-5-取消发布\" class=\"headerlink\" title=\"3.5. 取消发布\"></a>3.5. 取消发布</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vsce unpublish (publisher name).(extension name)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-6-更新\"><a href=\"#3-6-更新\" class=\"headerlink\" title=\"3.6. 更新\"></a>3.6. 更新</h2><p>如果修改了插件代码想要重新发布，只需要修改版本号然后重新执行<code>vsce publish</code>即可。</p>\n<h1 id=\"插件升级\"><a href=\"#插件升级\" class=\"headerlink\" title=\"插件升级\"></a>插件升级</h1><h2 id=\"4-1-发布到了应用市场\"><a href=\"#4-1-发布到了应用市场\" class=\"headerlink\" title=\"4.1. 发布到了应用市场\"></a>4.1. 发布到了应用市场</h2><p>如果发布到了应用市场，那么一般来说会自动检测有没有新版本，有的话会自动无感知升级，但具体什么时候会去检测我还没有研究过，已经确定的是在扩展面板搜索插件名字会自动检测，重启vscode也会检测。</p>\n<h2 id=\"4-2-如果是本地打包\"><a href=\"#4-2-如果是本地打包\" class=\"headerlink\" title=\"4.2. 如果是本地打包\"></a>4.2. 如果是本地打包</h2><p>如果是打包成<code>vsix</code>，那么只能自己实现升级检测功能呢，通过对比服务器上某个文件的版本号，具体我就不细讲了。</p>\n","text":"发布方式插件开发完了，如何发布出去分享给他人呢？主要有3种方法： 方法一：直接把文件夹发给别人，让别人找到vscode的插件存放目录并放进去，然后重启vscod...","permalink":"/post/vscode插件开发/6. 打包、发布、升级","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"vscode插件开发","slug":"vscode插件开发","count":7,"path":"api/tags/vscode插件开发.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%91%E5%B8%83%E6%96%B9%E5%BC%8F\"><span class=\"toc-text\">发布方式</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%9C%AC%E5%9C%B0%E6%89%93%E5%8C%85\"><span class=\"toc-text\">本地打包</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%91%E5%B8%83%E5%BA%94%E7%94%A8%E5%B8%82%E5%9C%BA\"><span class=\"toc-text\">发布应用市场</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-1-%E6%B3%A8%E5%86%8C%E8%B4%A6%E5%8F%B7\"><span class=\"toc-text\">3.1. 注册账号</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-2-%E5%88%9B%E5%BB%BA%E4%BB%A4%E7%89%8C\"><span class=\"toc-text\">3.2. 创建令牌</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-3-%E5%88%9B%E5%BB%BA%E5%8F%91%E5%B8%83%E8%B4%A6%E5%8F%B7\"><span class=\"toc-text\">3.3. 创建发布账号</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-4-%E5%8F%91%E5%B8%83\"><span class=\"toc-text\">3.4. 发布</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-4-1-%E5%8F%91%E5%B8%83%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9\"><span class=\"toc-text\">3.4.1. 发布注意事项</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-4-2-%E5%A2%9E%E9%87%8F%E5%8F%91%E5%B8%83\"><span class=\"toc-text\">3.4.2. 增量发布</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-5-%E5%8F%96%E6%B6%88%E5%8F%91%E5%B8%83\"><span class=\"toc-text\">3.5. 取消发布</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-6-%E6%9B%B4%E6%96%B0\"><span class=\"toc-text\">3.6. 更新</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%8F%92%E4%BB%B6%E5%8D%87%E7%BA%A7\"><span class=\"toc-text\">插件升级</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#4-1-%E5%8F%91%E5%B8%83%E5%88%B0%E4%BA%86%E5%BA%94%E7%94%A8%E5%B8%82%E5%9C%BA\"><span class=\"toc-text\">4.1. 发布到了应用市场</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#4-2-%E5%A6%82%E6%9E%9C%E6%98%AF%E6%9C%AC%E5%9C%B0%E6%89%93%E5%8C%85\"><span class=\"toc-text\">4.2. 如果是本地打包</span></a></li></ol></li></ol>","author":{"name":"MessageWall","slug":"blog-author","avatar":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2F0bcda423-149d-411d-a505-d29abc1ab6de%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1717404600&t=829a21da2f1f1a8181b572805d48b476","link":"/","description":"欢迎来到小王的博客～ <br/> 博客不定时更新，欢迎收藏","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"vue-property-decorator使用手册","uid":"aaae541336ce9c9a068b009d52c1b8e0","slug":"vue/vue-property-decorator使用手册","date":"2024-05-05T06:52:32.000Z","updated":"2024-05-05T06:52:33.993Z","comments":true,"path":"api/articles/vue/vue-property-decorator使用手册.json","keywords":null,"cover":null,"text":"一，安装1npm i -s vue-property-decorator vue-class-component 二，用法1，@Component(option...","permalink":"/post/vue/vue-property-decorator使用手册","photos":[],"count_time":{"symbolsCount":"7.7k","symbolsTime":"7 mins."},"categories":[],"tags":[{"name":"vue","slug":"vue","count":7,"path":"api/tags/vue.json"}],"author":{"name":"MessageWall","slug":"blog-author","avatar":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2F0bcda423-149d-411d-a505-d29abc1ab6de%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1717404600&t=829a21da2f1f1a8181b572805d48b476","link":"/","description":"欢迎来到小王的博客～ <br/> 博客不定时更新，欢迎收藏","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"方法","uid":"ff590af8a3e15078ecfbc463aea307fc","slug":"nodejs/Sequelize/方法","date":"2024-05-05T06:52:32.000Z","updated":"2024-05-05T06:52:33.999Z","comments":true,"path":"api/articles/nodejs/Sequelize/方法.json","keywords":null,"cover":null,"text":"Sequelize的相关方法查询相关的方法 findOne - 查询一条数据 findAll - 查询多条数据 count - 查询数据条数 参数 where ...","permalink":"/post/nodejs/Sequelize/方法","photos":[],"count_time":{"symbolsCount":85,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"Sequelize","slug":"Sequelize","count":3,"path":"api/tags/Sequelize.json"}],"author":{"name":"MessageWall","slug":"blog-author","avatar":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2F0bcda423-149d-411d-a505-d29abc1ab6de%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1717404600&t=829a21da2f1f1a8181b572805d48b476","link":"/","description":"欢迎来到小王的博客～ <br/> 博客不定时更新，欢迎收藏","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}