{"title":"7. 常用API总结","uid":"7485ac3dd1b5518a73477d38ad77532d","slug":"vscode插件开发/7. 常用API总结","date":"2024-05-05T06:52:32.000Z","updated":"2024-05-05T06:52:33.993Z","comments":true,"path":"api/articles/vscode插件开发/7. 常用API总结.json","keywords":null,"cover":[],"content":"<h1 id=\"编辑器相关\"><a href=\"#编辑器相关\" class=\"headerlink\" title=\"编辑器相关\"></a>编辑器相关</h1><h2 id=\"1-1-修改当前激活编辑器内容\"><a href=\"#1-1-修改当前激活编辑器内容\" class=\"headerlink\" title=\"1.1. 修改当前激活编辑器内容\"></a>1.1. 修改当前激活编辑器内容</h2><p>替换当前编辑器全部内容：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vscode.<span class=\"property\">window</span>.<span class=\"property\">activeTextEditor</span>.<span class=\"title function_\">edit</span>(<span class=\"function\"><span class=\"params\">editBuilder</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 从开始到结束，全量替换</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> end = <span class=\"keyword\">new</span> vscode.<span class=\"title class_\">Position</span>(vscode.<span class=\"property\">window</span>.<span class=\"property\">activeTextEditor</span>.<span class=\"property\">document</span>.<span class=\"property\">lineCount</span> + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">const</span> text = <span class=\"string\">&#x27;新替换的内容&#x27;</span>;</span><br><span class=\"line\">    editBuilder.<span class=\"title function_\">replace</span>(<span class=\"keyword\">new</span> vscode.<span class=\"title class_\">Range</span>(<span class=\"keyword\">new</span> vscode.<span class=\"title class_\">Position</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>), end), text);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"1-2-打开文件并选中某段文字\"><a href=\"#1-2-打开文件并选中某段文字\" class=\"headerlink\" title=\"1.2. 打开文件并选中某段文字\"></a>1.2. 打开文件并选中某段文字</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"string\">&#x27;/Users/somefile.txt&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> options = &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// 选中第3行第9列到第3行第17列</span></span><br><span class=\"line\">\t<span class=\"attr\">selection</span>: <span class=\"keyword\">new</span> vscode.<span class=\"title class_\">Range</span>(<span class=\"keyword\">new</span> vscode.<span class=\"title class_\">Position</span>(<span class=\"number\">2</span>, <span class=\"number\">8</span>), <span class=\"keyword\">new</span> vscode.<span class=\"title class_\">Position</span>(<span class=\"number\">2</span>, <span class=\"number\">16</span>));</span><br><span class=\"line\">\t<span class=\"comment\">// 是否预览，默认true，预览的意思是下次再打开文件是否会替换当前文件</span></span><br><span class=\"line\">\t<span class=\"attr\">preview</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">\t<span class=\"comment\">// 显示在第二个编辑器</span></span><br><span class=\"line\">\t<span class=\"attr\">viewColumn</span>: vscode.<span class=\"property\">ViewColumn</span>.<span class=\"property\">Two</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vscode.<span class=\"property\">window</span>.<span class=\"title function_\">showTextDocument</span>(vscode.<span class=\"property\">Uri</span>.<span class=\"title function_\">file</span>(path), options);</span><br></pre></td></tr></table></figure>\n\n<p><code>preview</code>为true相当于我们在文件管理器单击文件，此时标题是斜体（如下图），为false时则相当于双击。</p>\n<p><img src=\"http://image.haoji.me/201810/20181014_170104_430_7118.png\" alt=\"W740xH312\"></p>\n<h1 id=\"通知和状态栏\"><a href=\"#通知和状态栏\" class=\"headerlink\" title=\"通知和状态栏\"></a>通知和状态栏</h1><h2 id=\"2-1-提示\"><a href=\"#2-1-提示\" class=\"headerlink\" title=\"2.1. 提示\"></a>2.1. 提示</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vscode.<span class=\"property\">window</span>.<span class=\"title function_\">showInformationMessage</span>(<span class=\"string\">&#x27;我是info信息！&#x27;</span>);</span><br><span class=\"line\">vscode.<span class=\"property\">window</span>.<span class=\"title function_\">showErrorMessage</span>(<span class=\"string\">&#x27;我是错误信息！&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>自定义按钮带回调的提示：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vscode.<span class=\"property\">window</span>.<span class=\"title function_\">showInformationMessage</span>(<span class=\"string\">&#x27;是否要打开小茗同学的博客？&#x27;</span>, <span class=\"string\">&#x27;是&#x27;</span>, <span class=\"string\">&#x27;否&#x27;</span>, <span class=\"string\">&#x27;不再提示&#x27;</span>).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">result</span> =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (result === <span class=\"string\">&#x27;是&#x27;</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"title function_\">exec</span>(<span class=\"string\">`open &#x27;https://haoji.me&#x27;`</span>);</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (result === <span class=\"string\">&#x27;不再提示&#x27;</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// 其它操作</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-2-修改状态栏\"><a href=\"#2-2-修改状态栏\" class=\"headerlink\" title=\"2.2. 修改状态栏\"></a>2.2. 修改状态栏</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vscode.<span class=\"property\">window</span>.<span class=\"title function_\">setStatusBarMessage</span>(<span class=\"string\">&#x27;你好，前端艺术家！&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://image.haoji.me/201810/20181014_195136_570_1097.png\" alt=\"W594xH270\"></p>\n<p><code>setStatusBarMessage</code>只是<code>vscode.window.createStatusBarItem</code>的一种快捷调用方式，如需更多自定义设置可以使用这个方法。</p>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><p><a href=\"https://code.visualstudio.com/docs/extensionAPI/vscode-api\">https://code.visualstudio.com/docs/extensionAPI/vscode-api</a></p>\n","text":"编辑器相关1.1. 修改当前激活编辑器内容替换当前编辑器全部内容： 123456vscode.window.activeTextEditor.edit(edit...","permalink":"/post/vscode插件开发/7. 常用API总结","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"vscode插件开发","slug":"vscode插件开发","count":7,"path":"api/tags/vscode插件开发.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3\"><span class=\"toc-text\">编辑器相关</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-1-%E4%BF%AE%E6%94%B9%E5%BD%93%E5%89%8D%E6%BF%80%E6%B4%BB%E7%BC%96%E8%BE%91%E5%99%A8%E5%86%85%E5%AE%B9\"><span class=\"toc-text\">1.1. 修改当前激活编辑器内容</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-2-%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E5%B9%B6%E9%80%89%E4%B8%AD%E6%9F%90%E6%AE%B5%E6%96%87%E5%AD%97\"><span class=\"toc-text\">1.2. 打开文件并选中某段文字</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%80%9A%E7%9F%A5%E5%92%8C%E7%8A%B6%E6%80%81%E6%A0%8F\"><span class=\"toc-text\">通知和状态栏</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-1-%E6%8F%90%E7%A4%BA\"><span class=\"toc-text\">2.1. 提示</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-2-%E4%BF%AE%E6%94%B9%E7%8A%B6%E6%80%81%E6%A0%8F\"><span class=\"toc-text\">2.2. 修改状态栏</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83\"><span class=\"toc-text\">参考</span></a></li></ol>","author":{"name":"MessageWall","slug":"blog-author","avatar":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2F0bcda423-149d-411d-a505-d29abc1ab6de%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1717404600&t=829a21da2f1f1a8181b572805d48b476","link":"/","description":"欢迎来到小王的博客～ <br/> 博客不定时更新，欢迎收藏","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"6. 打包、发布、升级","uid":"4363a1c8f18b34e52ca1d5e6f6bd7690","slug":"vscode插件开发/6. 打包、发布、升级","date":"2024-05-05T06:52:32.000Z","updated":"2024-05-05T06:52:33.993Z","comments":true,"path":"api/articles/vscode插件开发/6. 打包、发布、升级.json","keywords":null,"cover":[],"text":"发布方式插件开发完了，如何发布出去分享给他人呢？主要有3种方法： 方法一：直接把文件夹发给别人，让别人找到vscode的插件存放目录并放进去，然后重启vscod...","permalink":"/post/vscode插件开发/6. 打包、发布、升级","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"vscode插件开发","slug":"vscode插件开发","count":7,"path":"api/tags/vscode插件开发.json"}],"author":{"name":"MessageWall","slug":"blog-author","avatar":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2F0bcda423-149d-411d-a505-d29abc1ab6de%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1717404600&t=829a21da2f1f1a8181b572805d48b476","link":"/","description":"欢迎来到小王的博客～ <br/> 博客不定时更新，欢迎收藏","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"typescript装饰器","uid":"e755fa687ba8e5a830b46f785612d7d7","slug":"typescript/typescript装饰器","date":"2024-05-05T06:52:32.000Z","updated":"2024-05-05T06:52:33.993Z","comments":true,"path":"api/articles/typescript/typescript装饰器.json","keywords":null,"cover":null,"text":"了解typescript装饰器 装饰器是一种特殊类型的声明，它能够附加到类、类的函数、类属性、类函数的参数上，以达到修改类的行为 一、装饰器的种类 根据装饰器的...","permalink":"/post/typescript/typescript装饰器","photos":[],"count_time":{"symbolsCount":"9.4k","symbolsTime":"9 mins."},"categories":[],"tags":[{"name":"typescript","slug":"typescript","count":1,"path":"api/tags/typescript.json"}],"author":{"name":"MessageWall","slug":"blog-author","avatar":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2F0bcda423-149d-411d-a505-d29abc1ab6de%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1717404600&t=829a21da2f1f1a8181b572805d48b476","link":"/","description":"欢迎来到小王的博客～ <br/> 博客不定时更新，欢迎收藏","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}